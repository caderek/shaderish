(function(){"use strict";function M(n,a,s,e,t,h,r){const f=t*h;for(;;){const c=Atomics.add(a,0,1);if(c>=f)return;const w=c*r,T=w+r,{w:g,h:b}=e,m=c%t,y=Math.trunc(c/t);for(let o=w,p=0;o<T;o+=4,p++){const L=p%8+m*8,Z=Math.trunc(p/8)+y*8,_=Math.fround((L+.5)/(g/2)-1),k=Math.fround(1-(Z+.5)/(b/2)),l=s(_,k,e);n[o]=l[0]*255,n[o+1]=l[1]*255,n[o+2]=l[2]*255,n[o+3]=l[3]*255}}}let i=null,S=null,E=null,d=0,u=0,I=0;onmessage=async n=>{const[a,...s]=n.data;switch(a){case"init":{const[e,t,h,r,f]=s;S=new Uint8ClampedArray(e,0,t),E=new Uint32Array(e,t,h/4),d=r,u=f,I=t/(d*u);break}case"loadShader":{const[e]=s;i=(await import(e)).fragment,self.postMessage("loaded");break}case"runShader":{if(!i)throw new Error("No shader provided");const[e,t]=s;M(S,E,i,e,d,u,I),self.postMessage("rendered");break}default:console.warn(`Message "${a}" is not handled.`)}}})();
