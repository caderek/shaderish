(function(){"use strict";function F(r,n,e,s,c,o){for(let t=c;t<o;t+=4){const l=t/4,h=l%n,d=Math.trunc(l/n),_=(h+.5)/(n/2)-1,y=1-(d+.5)/(n/2);r.set(e(_,y,s),t)}}function X(r,n,e,s){return new Uint8Array([r*255,n*255,e*255,s*255])}function Y(r,n,e){const s=e.t;let c=r/.7,o=n/.7,t=.2;const l=-1,h=1,d=c-t*l,_=o-t*h,y=d*d+_*_,v=.1+t/(y+1e-9),j=l/v,B=h/v,a=c*1+o*1,i=c*j+o*B,k=a*a+i*i,x=.5*Math.log(Math.max(k,1e-9))+s*t,q=Math.cos(x),D=Math.cos(x+33),E=Math.cos(x+11),G=q;let f=(a*q+i*D)/t,u=(a*E+i*G)/t,m=0,p=0;for(;t<9;){t+=1;const b=u*t+s,w=f*t+s;f+=.7*Math.sin(b)/t+.5,u+=.7*Math.sin(w)/t+.5,m+=1+Math.sin(f),p+=1+Math.sin(u)}const H=Math.sin(f/.3)*.4,I=Math.sin(u/.3)*.4,J=a*2,K=i*4,A=H+J,U=I+K,g=Math.sqrt(A*A+U*U),L=a*.6,N=a*-.4,O=a*-1,P=0,Q=m,R=p,T=p,V=m,W=2+g*g/4-g,Z=.5+1/(k+1e-9),z=Math.sqrt(c*c+o*o),tt=.03+Math.abs(z-.7),nt=W*Z*tt;function M(b,w){const st=-Math.exp(b)/(w*nt+1e-9);return 1-Math.exp(st)}return X(M(L,Q),M(N,R),M(O,T),M(P,V))}const $=Y;let C=null,S=0;onmessage=r=>{const[n,...e]=r.data;switch(n){case"init":{const[s,c]=e;C=new Uint8ClampedArray(s),S=c,console.log("Configured shared framebuffer");break}case"runShader":{const[s,c,o]=e;F(C,S,$,s,c,o),self.postMessage("rendered");break}default:console.warn(`Message "${n}" is not handled.`)}}})();
